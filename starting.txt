Stop all services first:
sudo systemctl stop nginx
pm2 delete all

Clear any remaining processes:
sudo pkill -f node

Check if ports are free:
sudo lsof -i :80
sudo lsof -i :443
sudo lsof -i :3000
sudo lsof -i :3001

Run the updated setup script:
sudo bash setup.sh


# Check Nginx error logs
sudo tail -f /var/log/nginx/error.log

# Check PM2 logs
pm2 logs

# Check system logs for port conflicts
sudo journalctl -xe


rm -rf node_modules package-lock.json
npm install --legacy-peer-deps


# Stop all PM2 processes
pm2 stop all

# Initialize the database
sudo -u postgres psql -c "DROP DATABASE IF EXISTS ${DB_DATABASE};"
sudo -u postgres psql -c "CREATE DATABASE ${DB_DATABASE} OWNER ${DB_USER};"
PGPASSWORD="${DB_PASSWORD}" psql -h localhost -U "${DB_USER}" -d "${DB_DATABASE}" -f database.sql

# Restart all PM2 processes
pm2 restart all